<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
	<h1 style = "font-family:Arial; background-color:powderblue; text-align:center; font-style:italic">Try To Catch Me!</h1>
	<p>Click the ball with the light blue outline. You will earn a point each click. Avoid clicking the ball with the green outline. It will deduct a point.</p>
	<svg  width="90%" height="90%" id='balloon' onload="mouseClick(evt)">	
		<rect width="100%" height="100%" style="fill:gainsboro; stroke-width:3; stroke:rgb(0,0,0)" />
		<circle cx= "50" cy= "50" r= "40" id="circle" stroke="turquoise" stroke-width="5" fill="midnightblue"  />	
		<circle cx= "50" cy= "50" r= "40" id="enemy" stroke="green" stroke-width="5" fill="blue"  />

 	</svg>
	<script>
		var svg = document.getElementById('balloon');
		var gamespeed = 2;
		var whenGameStart = 0;
		var points = 0;
		var repeat = 30;
		var numPoints = document.createElementNS('http://www.w3.org/2000/svg', 'text');
		var txt = document.createTextNode("points: 0");
		const balloon = document.getElementById('circle');
		const enemy = document.getElementById('enemy');
		var y = parseFloat(balloon.getAttributeNS(null, 'cy'));
		var x = parseFloat(balloon.getAttributeNS(null, 'cx'));
		var enemy_y = parseFloat(enemy.getAttributeNS(null, 'cy'));
		var enemy_x = parseFloat(enemy.getAttributeNS(null, 'cx'));
		var canvasHeight = svg.clientHeight;
		var canvasWidth = svg.clientWidth;
		var coord = document.getElementById('coord');
		var incr_x, incr_y;
		var incr_enemy_x, incr_enemy_y;
		console.log("Height: " + canvasHeight + " " + "Width: " + canvasWidth);
		numPoints.setAttributeNS(null, 'x', 5);
		numPoints.setAttributeNS(null, 'y', 15);
		numPoints.appendChild(txt);
		svg.appendChild(numPoints);
		
		function randomPos (timestamp) {
			if (repeat < 30) {
				repeat++;
				
			} else {
				incr_x = (Math.floor(Math.random() * 10)-5)*gamespeed;
				incr_y = (Math.floor(Math.random() * 10)-5)*gamespeed;
				incr_enemy_x = (Math.floor(Math.random() * 10)-5)*(gamespeed*2);
				incr_enemy_y = (Math.floor(Math.random() * 10)-5)*(gamespeed*2);
				repeat = 0;
				
			}
			
			canvasHeight = svg.clientHeight;
			canvasWidth = svg.clientWidth;

			if (x + incr_x < 40 || x + incr_x > canvasWidth - 40) {
				incr_x *= -1;
			}
			if (y + incr_y < 40 || y + incr_y > canvasHeight - 40) {
				incr_y *= -1;
			}
			if (enemy_x + incr_enemy_x < 40 || enemy_x + incr_enemy_x > canvasWidth - 40) {
				incr_enemy_x *= -1;
			}
			if (enemy_y + incr_enemy_x < 40 || enemy_y + incr_enemy_y > canvasHeight - 40) {
				incr_enemy_y *= -1;
			}
			
			x += incr_x;
			y += incr_y;
			enemy_x += incr_enemy_x;
			enemy_y += incr_enemy_y;
			
			
			balloon.setAttributeNS(null, 'cx', x);
			balloon.setAttributeNS(null,'cy', y);
			enemy.setAttributeNS(null, 'cx', enemy_x);
			enemy.setAttributeNS(null,'cy', enemy_y);
			window.requestAnimationFrame(randomPos);
		}
		
		function mouseClick(evt) {
			var svg = evt.target;
			evt.preventDefault();
			svg.addEventListener('mouseup', startGame);
			
			function startGame(evt) {
				var target = evt.target;
				evt.preventDefault();
				if (target.getAttributeNS(null, "id") == "circle" && whenGameStart > 0) {
					points++;
					numPoints.innerHTML = "points: " + points;
				}
				if (target.getAttributeNS(null, "id") == "enemy" && whenGameStart > 0) {
					points--;
					numPoints.innerHTML = "points: " + points;
				}
				
				if (whenGameStart == 0) {
					window.requestAnimationFrame(randomPos);
					whenGameStart = 1;
				} 
				
				
			}
		}		
		
		function moveleft(timestamp) {
			x -= gamespeed;
			balloon.setAttributeNS(null, 'cx', x);
			
			if (x>50) { 
				window.requestAnimationFrame(moveleft);
			} else {
				if (points < 11) {
					window.requestAnimationFrame(movedown);
				} else {
					window.requestAnimationFrame(randomPos);
				}
			}
		}
		
		function moveup(timestamp) {
			y -= gamespeed;
			balloon.setAttributeNS(null, 'cy', y);
			
			if (y>50) {
				window.requestAnimationFrame(moveup);
			} else {
				if (points < 11) {
					window.requestAnimationFrame(moveleft);
				} else {
					window.requestAnimationFrame(randomPos);
				}
			}
		}
		
		
		function moveright(timestamp) {
			x += gamespeed;
			balloon.setAttributeNS(null, 'cx', x);
			
			if (x<2000) {
				window.requestAnimationFrame(moveright);
			} else {
				if (points < 11) {
					window.requestAnimationFrame(moveup);
				} else {
					window.requestAnimationFrame(randomPos);
				}
			}
		}
		
		function movedown(timestamp) {
			y += gamespeed;
			balloon.setAttributeNS(null, 'cy', y);
			
			if (y<550) {
				window.requestAnimationFrame(movedown);
			} else {
				if (points < 11) {
					window.requestAnimationFrame(moveright);
				} else {
					window.requestAnimationFrame(randomPos);	
				}
			}
		}

	</script>
</body>
</html>